<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TikTok Gift Climber</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      font-family: system-ui, sans-serif;
      color: white;
    }
    .hint {
      position: absolute;
      top: 16px;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 16px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 999px;
      font-size: 14px;
      z-index: 10;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
  </style>
</head>
<body>
<div class="hint">Press <b>G</b> to add a new climber · Drag to look around · Scroll to zoom</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r152/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/three@0.152/examples/js/controls/OrbitControls.js"></script>

<script>
// -----------------------------------------------------
// BASIC SCENE SETUP
// -----------------------------------------------------
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x050814);
scene.fog = new THREE.Fog(0x050814, 15, 90);

const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  200
);
camera.position.set(15, 12, 22);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
renderer.outputEncoding = THREE.sRGBEncoding;
renderer.physicallyCorrectLights = true;
document.body.appendChild(renderer.domElement);

// Orbit controls so you can drag / zoom
const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.target.set(0, 8, 0);
controls.enableDamping = true;
controls.dampingFactor = 0.05;
controls.update();

// -----------------------------------------------------
// LIGHTING & SKY
// -----------------------------------------------------
const hemiLight = new THREE.HemisphereLight(0x88bbff, 0x223344, 0.9);
scene.add(hemiLight);

const dirLight = new THREE.DirectionalLight(0xfff2cc, 2.0);
dirLight.position.set(20, 30, 10);
dirLight.castShadow = true;
dirLight.shadow.mapSize.set(2048, 2048);
scene.add(dirLight);

// simple glowing sun sprite
const sunGeo = new THREE.SphereGeometry(1.3, 16, 16);
const sunMat = new THREE.MeshBasicMaterial({ color: 0xfff2cc });
const sun = new THREE.Mesh(sunGeo, sunMat);
sun.position.copy(dirLight.position);
scene.add(sun);

// -----------------------------------------------------
// GROUND & MOUNTAIN
// -----------------------------------------------------
const groundGeo = new THREE.CircleGeometry(40, 64);
const groundMat = new THREE.MeshStandardMaterial({
  color: 0x1b2838,
  roughness: 0.9,
  metalness: 0.0
});
const ground = new THREE.Mesh(groundGeo, groundMat);
ground.rotation.x = -Math.PI / 2;
ground.receiveShadow = true;
scene.add(ground);

// Smooth, high-res mountain cone
const mountainGeo = new THREE.ConeGeometry(12, 32, 64, 32);
const mountainMat = new THREE.MeshStandardMaterial({
  color: 0x4b5664,
  roughness: 0.95,
  metalness: 0.05,
  flatShading: false
});
const mountain = new THREE.Mesh(mountainGeo, mountainMat);
mountain.position.y = 8;
mountain.castShadow = true;
mountain.receiveShadow = true;
scene.add(mountain);

// Snow cap
const snowGeo = new THREE.ConeGeometry(5, 8, 48, 16);
const snowMat = new THREE.MeshStandardMaterial({
  color: 0xf5faff,
  roughness: 0.6,
  metalness: 0.0
});
const snow = new THREE.Mesh(snowGeo, snowMat);
snow.position.y = mountain.position.y + 16;
snow.castShadow = true;
scene.add(snow);

// -----------------------------------------------------
// CLIMBER CREATION
// -----------------------------------------------------
const climbers = [];

function createClimberModel() {
  const group = new THREE.Group();

  const bodyMat = new THREE.MeshStandardMaterial({
    color: 0x3399ff,
    roughness: 0.6,
    metalness: 0.1
  });
  const legMat = new THREE.MeshStandardMaterial({
    color: 0x222222,
    roughness: 0.8,
    metalness: 0.0
  });
  const headMat = new THREE.MeshStandardMaterial({
    color: 0xffddc0,
    roughness: 0.7,
    metalness: 0.0
  });
  const packMat = new THREE.MeshStandardMaterial({
    color: 0xff3366,
    roughness: 0.6,
    metalness: 0.1
  });

  // Torso
  const torsoGeo = new THREE.BoxGeometry(0.7, 1.2, 0.4);
  const torso = new THREE.Mesh(torsoGeo, bodyMat);
  torso.position.y = 1.6;
  torso.castShadow = true;
  group.add(torso);

  // Head
  const headGeo = new THREE.SphereGeometry(0.35, 24, 24);
  const head = new THREE.Mesh(headGeo, headMat);
  head.position.y = 2.5;
  head.castShadow = true;
  group.add(head);

  // Backpack
  const packGeo = new THREE.BoxGeometry(0.4, 0.9, 0.25);
  const pack = new THREE.Mesh(packGeo, packMat);
  pack.position.set(0, 1.7, -0.3);
  pack.castShadow = true;
  group.add(pack);

  // Legs
  const legGeo = new THREE.BoxGeometry(0.25, 1.1, 0.25);
  const leftLeg = new THREE.Mesh(legGeo, legMat);
  const rightLeg = new THREE.Mesh(legGeo, legMat);
  leftLeg.position.set(-0.18, 0.7, 0);
  rightLeg.position.set(0.18, 0.7, 0);
  leftLeg.castShadow = rightLeg.castShadow = true;
  group.add(leftLeg, rightLeg);

  // Arms
  const armGeo = new THREE.BoxGeometry(0.2, 0.9, 0.2);
  const leftArm = new THREE.Mesh(armGeo, bodyMat);
  const rightArm = new THREE.Mesh(armGeo, bodyMat);
  leftArm.position.set(-0.55, 1.8, 0);
  rightArm.position.set(0.55, 1.8, 0);
  leftArm.castShadow = rightArm.castShadow = true;
  group.add(leftArm, rightArm);

  // Store limb refs for animation
  group.userData.limbs = { leftLeg, rightLeg, leftArm, rightArm };
  return group;
}

// Add a new climber spiralling up the mountain
function addClimber() {
  const model = createClimberModel();
  const tStart = Math.random() * Math.PI * 2;

  model.userData.t = tStart;                // progress along path
  model.userData.speed = 0.4 + Math.random() * 0.4; // climb speed
  model.userData.phase = Math.random() * Math.PI * 2; // leg/arm phase

  climbers.push(model);
  scene.add(model);
}

// First climber
addClimber();

// Keyboard: press G to spawn new climber
window.addEventListener("keydown", (e) => {
  if (e.key === "g" || e.key === "G") {
    addClimber();
  }
});

// -----------------------------------------------------
// ANIMATION LOOP
// -----------------------------------------------------
const clock = new THREE.Clock();

function animate() {
  requestAnimationFrame(animate);
  const delta = clock.getDelta();
  const time = clock.elapsedTime;

  controls.update();

  // Soft sun movement for a dynamic look
  const sunRadius = 40;
  dirLight.position.set(
    Math.cos(time * 0.1) * sunRadius,
    30,
    Math.sin(time * 0.1) * sunRadius
  );
  sun.position.copy(dirLight.position);

  // Update each climber
  climbers.forEach((c) => {
    c.userData.t += delta * c.userData.speed;

    const t = c.userData.t;
    const height = 2 + t * 0.8;          // goes up
    let radius = 10 - t * 0.6;           // spirals inward
    radius = Math.max(radius, 2.5);      // don't go into the peak

    const x = Math.cos(t) * radius;
    const z = Math.sin(t) * radius;
    const y = height;

    c.position.set(x, y, z);
    c.lookAt(0, y + 0.5, 0); // face towards the mountain

    // Walking / climbing animation
    const swing = Math.sin(t * 4 + c.userData.phase) * 0.6;
    const limbs = c.userData.limbs;
    if (limbs) {
      limbs.leftLeg.rotation.x = swing;
      limbs.rightLeg.rotation.x = -swing;
      limbs.leftArm.rotation.x = -swing * 0.7;
      limbs.rightArm.rotation.x = swing * 0.7;
    }
  });

  renderer.render(scene, camera);
}

animate();

// Handle resize
window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
