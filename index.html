<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>TikTok Gift Climber</title>
  <style>
    body {
      margin: 0;
      overflow: hidden;
      background: #000;
      font-family: system-ui, sans-serif;
      color: white;
    }
    .hint {
      position: absolute;
      top: 16px;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 16px;
      background: rgba(0, 0, 0, 0.5);
      border-radius: 999px;
      font-size: 14px;
      z-index: 10;
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
    }
  </style>
</head>
<body>
<div class="hint">Press <b>G</b> to add a new climber · Drag to look around · Scroll to zoom</div>

<!-- Use official threejs.org URLs (less likely to be blocked) -->
<script src="https://threejs.org/build/three.min.js"></script>
<script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>

<script>
// If THREE failed to load, show a clear message
if (!window.THREE) {
  alert(
    "Three.js failed to load. Your network might be blocking threejs.org.\n\n" +
    "Try on a different network / device if this keeps happening."
  );
}

// -----------------------------------------------------
// BASIC SCENE SETUP
// -----------------------------------------------------
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x050814);
scene.fog = new THREE.Fog(0x050814, 20, 120);

const camera = new THREE.PerspectiveCamera(
  60,
  window.innerWidth / window.innerHeight,
  0.1,
  300
);
camera.position.set(18, 14, 26);

const renderer = new THREE.WebGLRenderer({ antialias: true });
renderer.setSize(window.innerWidth, window.innerHeight);
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
renderer.setClearColor(0x050814);
document.body.appendChild(renderer.domElement);

// Orbit controls
const controls = new THREE.OrbitControls(camera, renderer.domElement);
controls.target.set(0, 10, 0);
controls.enableDamping = true;

// -----------------------------------------------------
// LIGHTING & SKY
// -----------------------------------------------------
const hemiLight = new THREE.HemisphereLight(0x99bbff, 0x101622, 0.9);
scene.add(hemiLight);

const dirLight = new THREE.DirectionalLight(0xfff2cc, 1.4);
dirLight.position.set(35, 40, 20);
scene.add(dirLight);

// Sun sphere for a nice look
const sunGeo = new THREE.SphereGeometry(2, 24, 24);
const sunMat = new THREE.MeshBasicMaterial({ color: 0xfff2cc });
const sun = new THREE.Mesh(sunGeo, sunMat);
sun.position.copy(dirLight.position);
scene.add(sun);

// -----------------------------------------------------
// GROUND & MOUNTAIN
// -----------------------------------------------------
const groundGeo = new THREE.CircleGeometry(60, 96);
const groundMat = new THREE.MeshStandardMaterial({
  color: 0x1c2836,
  roughness: 0.9
});
const ground = new THREE.Mesh(groundGeo, groundMat);
ground.rotation.x = -Math.PI / 2;
scene.add(ground);

const mountainGeo = new THREE.ConeGeometry(15, 40, 96, 48);
const mountainMat = new THREE.MeshStandardMaterial({
  color: 0x485463,
  roughness: 0.95,
  metalness: 0.05
});
const mountain = new THREE.Mesh(mountainGeo, mountainMat);
mountain.position.y = 12;
scene.add(mountain);

// Snow cap
const snowGeo = new THREE.ConeGeometry(6, 10, 64, 32);
const snowMat = new THREE.MeshStandardMaterial({
  color: 0xf7fbff,
  roughness: 0.7
});
const snow = new THREE.Mesh(snowGeo, snowMat);
snow.position.y = mountain.position.y + 20;
scene.add(snow);

// -----------------------------------------------------
// CLIMBER CREATION
// -----------------------------------------------------
const climbers = [];

function createClimberModel() {
  const group = new THREE.Group();

  const bodyMat = new THREE.MeshStandardMaterial({
    color: 0x3399ff,
    roughness: 0.6
  });
  const legMat = new THREE.MeshStandardMaterial({
    color: 0x222222,
    roughness: 0.8
  });
  const headMat = new THREE.MeshStandardMaterial({
    color: 0xffddc0,
    roughness: 0.7
  });
  const packMat = new THREE.MeshStandardMaterial({
    color: 0xff3366,
    roughness: 0.6
  });

  // Torso
  const torsoGeo = new THREE.BoxGeometry(0.9, 1.4, 0.5);
  const torso = new THREE.Mesh(torsoGeo, bodyMat);
  torso.position.y = 1.9;
  group.add(torso);

  // Head
  const headGeo = new THREE.SphereGeometry(0.4, 24, 24);
  const head = new THREE.Mesh(headGeo, headMat);
  head.position.y = 2.8;
  group.add(head);

  // Backpack
  const packGeo = new THREE.BoxGeometry(0.5, 1.1, 0.3);
  const pack = new THREE.Mesh(packGeo, packMat);
  pack.position.set(0, 2.0, -0.35);
  group.add(pack);

  // Legs
  const legGeo = new THREE.BoxGeometry(0.3, 1.3, 0.3);
  const leftLeg = new THREE.Mesh(legGeo, legMat);
  const rightLeg = new THREE.Mesh(legGeo, legMat);
  leftLeg.position.set(-0.25, 1.1, 0);
  rightLeg.position.set(0.25, 1.1, 0);
  group.add(leftLeg, rightLeg);

  // Arms
  const armGeo = new THREE.BoxGeometry(0.24, 1.0, 0.24);
  const leftArm = new THREE.Mesh(armGeo, bodyMat);
  const rightArm = new THREE.Mesh(armGeo, bodyMat);
  leftArm.position.set(-0.8, 2.1, 0);
  rightArm.position.set(0.8, 2.1, 0);
  group.add(leftArm, rightArm);

  group.userData.limbs = { leftLeg, rightLeg, leftArm, rightArm };
  return group;
}

function addClimber() {
  const model = createClimberModel();
  const startT = Math.random() * Math.PI * 2;

  model.userData.t = startT;
  model.userData.speed = 0.3 + Math.random() * 0.5;
  model.userData.phase = Math.random() * Math.PI * 2;

  climbers.push(model);
  scene.add(model);
}

// Add one initial climber
addClimber();

// Keyboard: press G to spawn a new climber
window.addEventListener("keydown", (e) => {
  if (e.key === "g" || e.key === "G") {
    addClimber();
  }
});

// -----------------------------------------------------
// ANIMATION LOOP
// -----------------------------------------------------
const clock = new THREE.Clock();

function animate() {
  requestAnimationFrame(animate);
  const delta = clock.getDelta();
  const time = clock.elapsedTime;

  controls.update();

  // Move the sun a bit for a dynamic sky
  const sunRadius = 60;
  dirLight.position.set(
    Math.cos(time * 0.05) * sunRadius,
    40,
    Math.sin(time * 0.05) * sunRadius
  );
  sun.position.copy(dirLight.position);

  climbers.forEach((c) => {
    c.userData.t += delta * c.userData.speed;
    const t = c.userData.t;

    // spiral path parameters
    const height = 4 + t * 0.9;
    let radius = 13 - t * 0.6;
    radius = Math.max(radius, 3.2);

    const x = Math.cos(t) * radius;
    const z = Math.sin(t) * radius;
    const y = height;

    c.position.set(x, y, z);
    c.lookAt(0, y + 0.5, 0);

    const swing = Math.sin(t * 4 + c.userData.phase) * 0.7;
    const limbs = c.userData.limbs;
    if (limbs) {
      limbs.leftLeg.rotation.x = swing;
      limbs.rightLeg.rotation.x = -swing;
      limbs.leftArm.rotation.x = -swing * 0.7;
      limbs.rightArm.rotation.x = swing * 0.7;
    }
  });

  renderer.render(scene, camera);
}

animate();

// Resize handling
window.addEventListener("resize", () => {
  camera.aspect = window.innerWidth / window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});
</script>
</body>
</html>
